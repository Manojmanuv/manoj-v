<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cart Page - EcoFinds</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f8fa;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="max-w-md mx-auto bg-white min-h-screen">
        <!-- Header -->
        <header class="flex items-center justify-between p-4 border-b border-gray-200 bg-white">
            <!-- Back Button -->
            <button onclick="goBack()" class="p-2 rounded-lg hover:bg-gray-100 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-gray-600">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18" />
                </svg>
            </button>
            
            <!-- Logo -->
            <div class="flex items-center gap-2">
                <svg width="32" height="32" viewBox="0 0 40 40" class="w-8 h-8">
                    <circle cx="20" cy="20" r="18" fill="#2d5a27" stroke="#4a7c59" stroke-width="2"/>
                    <path d="M12 20c0-4 3-7 8-7s8 3 8 7c0 2-1 4-2 5l-6 6-6-6c-1-1-2-3-2-5z" fill="#ffffff" opacity="0.9"/>
                    <circle cx="20" cy="16" r="2" fill="#ffffff"/>
                    <path d="M18 20l2 2 2-2" stroke="#ffffff" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <h1 class="text-lg font-bold text-gray-800">EcoFinds</h1>
            </div>
            
            <!-- Profile Icon -->
            <button class="p-2 rounded-lg hover:bg-gray-100 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-gray-600">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a.5.5 0 01-.29-.115c-.218-.184-.452-.324-.694-.438a.75.75 0 00-.712 0A14.255 14.255 0 0112 18a14.25 14.25 0 01-4.706-1.132.75.75 0 00-.712 0c-.242.114-.476.254-.694.438a.5.5 0 01-.29.115M12 12a4.5 4.5 0 110-9 4.5 4.5 0 010 9z" />
                </svg>
            </button>
        </header>

        <!-- Page Title -->
        <div class="px-4 py-3 border-b border-gray-100">
            <h2 class="text-xl font-semibold text-gray-800">Cart Page</h2>
        </div>

        <!-- Cart Items Container -->
        <div class="p-4">
            <div id="cart-items-container" class="bg-white rounded-lg border border-gray-200 p-4 min-h-[400px]">
                <!-- Cart items will be dynamically loaded here -->
                <div id="empty-cart" class="text-center py-12">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-16 h-16 text-gray-300 mx-auto mb-4">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 00-3 3h15.75m-12.75-3h11.218c1.533 0 2.847-1.182 2.99-2.691L21 9.75M14.25 14.25a3 3 0 10-3 3m3-3a3 3 0 10-3 3m-9.75-9.75h1.562c.556 0 1.107.233 1.503.62L18.75 11.25m-12.25-9.75a3 3 0 10-3 3m3-3a3 3 0 10-3 3" />
                    </svg>
                    <h3 class="text-lg font-medium text-gray-500 mb-2">Your cart is empty</h3>
                    <p class="text-gray-400 text-sm">Add some items to get started!</p>
                    <button onclick="goToLanding()" class="mt-4 bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors">
                        Continue Shopping
                    </button>
                </div>
            </div>
        </div>

        <!-- Total Price Section -->
        <div class="px-4 py-3 border-t border-gray-200 bg-white">
            <div class="flex justify-between items-center">
                <span class="text-lg font-semibold text-gray-800">Total price to pay:</span>
                <span id="total-price" class="text-xl font-bold text-green-600">Rs. 0</span>
            </div>
        </div>

        <!-- Checkout Button -->
        <div class="p-4 bg-white border-t border-gray-200">
            <button id="checkout-btn" onclick="proceedToCheckout()" class="w-full bg-green-600 text-white py-4 rounded-lg font-semibold text-lg hover:bg-green-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed" disabled>
                Checkout
            </button>
        </div>
    </div>

    <script>
        // Cart data structure
        let cartItems = [];

        // Load cart items from localStorage on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadCartItems();
            displayCartItems();
            updateTotalPrice();
        });

        // Load cart items from localStorage
        function loadCartItems() {
            const savedCart = localStorage.getItem('ecofinds_cart');
            if (savedCart) {
                cartItems = JSON.parse(savedCart);
            }
        }

        // Save cart items to localStorage
        function saveCartItems() {
            localStorage.setItem('ecofinds_cart', JSON.stringify(cartItems));
        }

        // Display cart items
        function displayCartItems() {
            const container = document.getElementById('cart-items-container');
            const emptyCart = document.getElementById('empty-cart');
            const checkoutBtn = document.getElementById('checkout-btn');

            if (cartItems.length === 0) {
                emptyCart.style.display = 'block';
                checkoutBtn.disabled = true;
                return;
            }

            emptyCart.style.display = 'none';
            checkoutBtn.disabled = false;

            // Clear existing items
            container.innerHTML = '';

            cartItems.forEach((item, index) => {
                const cartItem = document.createElement('div');
                cartItem.className = 'flex items-center gap-3 p-3 border-b border-gray-100 last:border-b-0';
                cartItem.setAttribute('data-index', index);
                
                cartItem.innerHTML = `
                    <div class="w-16 h-16 bg-gray-200 rounded-lg overflow-hidden flex-shrink-0">
                        <img src="${item.image}" alt="${item.name}" class="w-full h-full object-cover">
                    </div>
                    <div class="flex-1 min-w-0">
                        <h3 class="font-medium text-gray-800 truncate">${item.name}</h3>
                        <p class="text-sm text-gray-500">${item.category}</p>
                        <div class="flex items-center justify-between mt-2">
                            <div class="flex items-center gap-2">
                                <button class="decrease-btn w-6 h-6 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 hover:bg-gray-300 transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-3 h-3">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 12h-15" />
                                    </svg>
                                </button>
                                <span class="quantity-display w-8 text-center font-medium">${item.quantity}</span>
                                <button class="increase-btn w-6 h-6 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 hover:bg-gray-300 transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-3 h-3">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                                    </svg>
                                </button>
                            </div>
                            <div class="text-right">
                                <p class="item-total font-semibold text-gray-800">Rs. ${(item.price * item.quantity).toFixed(2)}</p>
                                <button class="remove-btn text-red-500 text-xs hover:text-red-700 transition-colors">
                                    Remove
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                
                // Add event listeners
                const decreaseBtn = cartItem.querySelector('.decrease-btn');
                const increaseBtn = cartItem.querySelector('.increase-btn');
                const removeBtn = cartItem.querySelector('.remove-btn');
                
                decreaseBtn.addEventListener('click', () => updateQuantity(index, -1));
                increaseBtn.addEventListener('click', () => updateQuantity(index, 1));
                removeBtn.addEventListener('click', () => removeItem(index));
                
                container.appendChild(cartItem);
            });
        }

        // Update item quantity
        function updateQuantity(index, change) {
            if (index < 0 || index >= cartItems.length) return;
            
            cartItems[index].quantity += change;
            
            if (cartItems[index].quantity <= 0) {
                cartItems.splice(index, 1);
            }
            
            saveCartItems();
            displayCartItems();
            updateTotalPrice();
            
            // Update cart count on landing page if it exists
            if (window.opener && window.opener.updateCartCount) {
                window.opener.updateCartCount();
            }
        }

        // Remove item from cart
        function removeItem(index) {
            if (index < 0 || index >= cartItems.length) return;
            
            // Show confirmation
            if (confirm('Are you sure you want to remove this item from your cart?')) {
                cartItems.splice(index, 1);
                saveCartItems();
                displayCartItems();
                updateTotalPrice();
                
                // Update cart count on landing page if it exists
                if (window.opener && window.opener.updateCartCount) {
                    window.opener.updateCartCount();
                }
            }
        }

        // Update total price
        function updateTotalPrice() {
            const total = cartItems.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            document.getElementById('total-price').textContent = `Rs. ${total.toFixed(2)}`;
        }

        // Go back to previous page
        function goBack() {
            if (document.referrer && document.referrer.includes('landing.html')) {
                window.history.back();
            } else {
                window.location.href = 'landing.html';
            }
        }

        // Go to landing page
        function goToLanding() {
            window.location.href = 'landing.html';
        }

        // Proceed to checkout
        function proceedToCheckout() {
            if (cartItems.length === 0) {
                alert('Your cart is empty!');
                return;
            }
            
            // For now, just show an alert
            alert(`Proceeding to checkout with ${cartItems.length} items. Total: Rs. ${cartItems.reduce((sum, item) => sum + (item.price * item.quantity), 0).toFixed(2)}`);
            
            // In a real app, you would redirect to a checkout page
            // window.location.href = 'checkout.html';
        }
    </script>
</body>
</html>
